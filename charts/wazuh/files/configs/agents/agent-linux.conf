<agent_config os="Linux">
  <!-- ==================== -->
  <!-- LINUX CONFIGURATION  -->
  <!-- ==================== -->

  <!-- System Inventory - Package/App monitoring -->
  <wodle name="syscollector">
    <disabled>no</disabled>
    <interval>1h</interval>
    <scan_on_start>yes</scan_on_start>
    <synchronize>yes</synchronize>
    <hardware>yes</hardware>
    <os>yes</os>
    <network>yes</network>
    <packages>yes</packages>
    <ports all="no">yes</ports>
    <processes>yes</processes>
  </wodle>

  <!-- File Integrity Monitoring -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency>
    <scan_on_start>yes</scan_on_start>
    <alert_new_files>yes</alert_new_files>
    <auto_ignore frequency="10" timeframe="3600">no</auto_ignore>

    <!-- Critical directories with real-time monitoring -->
    <directories realtime="yes" check_all="yes">/etc</directories>
    <directories realtime="yes" check_all="yes">/usr/bin,/usr/sbin</directories>
    <directories realtime="yes" check_all="yes">/bin,/sbin</directories>
    <directories check_all="yes">/boot</directories>

    <!-- Home directories -->
    <directories realtime="yes" check_all="yes">/root</directories>
    <directories check_all="yes">/home</directories>

    <!-- SSH configurations -->
    <directories realtime="yes" check_all="yes">/root/.ssh</directories>

    <!-- Cron jobs -->
    <directories realtime="yes" check_all="yes">/etc/cron.d,/etc/cron.daily,/etc/cron.hourly,/etc/cron.monthly,/etc/cron.weekly</directories>
    <directories realtime="yes" check_all="yes">/var/spool/cron</directories>

    <!-- Systemd services -->
    <directories realtime="yes" check_all="yes">/etc/systemd/system</directories>
    <directories check_all="yes">/lib/systemd/system</directories>

    <!-- Standard ignores -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/random.seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>
    <ignore>/etc/utmpx</ignore>
    <ignore>/etc/wtmpx</ignore>
    <ignore>/etc/cups/certs</ignore>
    <ignore>/etc/dumpdates</ignore>
    <ignore>/etc/svc/volatile</ignore>
    <ignore type="sregex">.log$|.swp$|.tmp$</ignore>

    <!-- CUPS temp files (frequent updates) -->
    <ignore type="sregex">/etc/cups/.*\.N$</ignore>

    <!-- Browser caches (noisy, low security value) -->
    <ignore type="sregex">/home/.*/snap/firefox/common/.cache</ignore>
    <ignore type="sregex">/home/.*/.cache/mozilla</ignore>
    <ignore type="sregex">/home/.*/.cache/chromium</ignore>
    <ignore type="sregex">/home/.*/.cache/google-chrome</ignore>

    <!-- Sensitive files - no diff -->
    <nodiff>/etc/ssl/private.key</nodiff>
    <nodiff>/etc/shadow</nodiff>

    <skip_nfs>yes</skip_nfs>
    <skip_dev>yes</skip_dev>
    <skip_proc>yes</skip_proc>
    <skip_sys>yes</skip_sys>
    <max_eps>100</max_eps>
  </syscheck>

  <!-- Log Collection -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/secure</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/messages</location>
  </localfile>

  <!-- Package manager logs for app install events -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/dpkg.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/apt/history.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/yum.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/dnf.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/kern.log</location>
  </localfile>

  <!-- Audit logs (if auditd is installed) -->
  <localfile>
    <log_format>audit</log_format>
    <location>/var/log/audit/audit.log</location>
  </localfile>

  <!-- Commands -->
  <localfile>
    <log_format>command</log_format>
    <command>df -P</command>
    <frequency>360</frequency>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>netstat -tulpn | sed 's/\([[:alnum:]]\+\)\ \+[[:digit:]]\+\ \+[[:digit:]]\+\ \+\(.*\):\([[:digit:]]*\)\ \+\([0-9\.\:\*]\+\).\+\ \([[:digit:]]*\/[[:alnum:]\-]*\).*/\1 \2 == \3 == \4 \5/' | sort -k 4 -g | sed 's/ == \(.*\) ==/:\1/' | sed 1,2d</command>
    <alias>netstat listening ports</alias>
    <frequency>360</frequency>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>last -n 20</command>
    <frequency>360</frequency>
  </localfile>

  <!-- Docker logs (if Docker is installed) -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/docker.log</location>
  </localfile>

  <!-- DNS Query Logging (dnsmasq if used) -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/dnsmasq.log</location>
  </localfile>
</agent_config>
